Das Problem der globalen Beleuchtung durch physikalisch basierter Monte-Carlo Integration und gleichzeitiges Erreichen der 
Echtzeitanforderung von 30$\frac{Bilder}{s}$ ist ein bekanntes Problem. Dazugehörige bekannte Lösungsansätze 
ziehen bereits temporale Lösungsansätze z.B. temporales Akkumulieren \cite{schied2017spatiotemporal} in Betracht. 
\par 

Eine klassisches Formulierung \cite{UE4TAA} haben wir beispielhaft wie im Folgenden angewandt:

\begin{tcolorbox}
  \begin{algorithm}[H]
    \caption{Beispielhafte Akkumulation}
    \begin{algorithmic}[1]
        \State Texture2D current\_frame;
        \State RWTexture2D accumulation\_buffer;
        \State float4 current\_color = current\_frame[pixel\_pos];
        \State float4 prev\_color = accumulation\_buffer[pixel\_pos];
        \State accumulation\_buffer[pixel\_pos] = 
        \State (frame\_count * prev\_color + current\_color) / (frame\_count + 1);
    \end{algorithmic}
    \label{alg:TemporalAccumulation}
\end{algorithm}
\end{tcolorbox}

Diese klassische Formulierung, verletzt unsere Annahme für die Quantilfunktion \ref{eq:inverse Funktion}
in den \nameref{ch:Content2:sec:a Posteriori}-Bedingungen des zugrundeliegenden Algorithmus 
\ref{ch:Temporaler Algorithmus}. Denn durch diese Akkumulation bestimmt nicht mehr allein der 
Anfangswert die Pixelfarbe!
\par 

\begin{figure}[H]
    
    \label{subsec:Temporales Projezieren}
\end{figure}
Um die a Posteriori Annahmen anwenden zu können und die Vorbedingungen der Quantilfunktion \ref{eq:inverse Funktion}
für unseren Algorithmus zu erfüllen brauchen wir eine erneute Permutation! Denn durch die Permutation haben wir wieder garantiert, 
dass je ein Anfangswert $x \in [0,1]$ auf je ein Pixelfarbwert abbgebildet wird. Wir nehmen die Idee zur Verbesserung der Zeitkohärenz
aus \cite[S.9/10]{hal02158423} auf. Da unser Algorithmus davon ausgeht, dass zwei aufeinanderfolgende Bilder gleiche Pixelwerte 
besitzen, erhoffen wir uns durch eine temporale Projektion ein Verbesserung bei der \nameref{ch:Content1:sec:blue noise} Verteilung 
falls sich z.B. durch Kamerabewegung die Farbgebung der Pixel zwischen Ihnen ändert. Die temporale Projektion, welche wir hier 
anwenden, baut auf aktuelle verbreitete Techniken des TAA auf \cite{INSIDETAA}.

\begin{figure}[H]
        \centering
        \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/TemporalReprojectPrincipal.png}
        \caption{Übersicht Temporal Reprojection}
        \label{pic:Uebersicht_Temporal_Reprojection}
\end{figure}

Wir benutzen die berechneten Tiefenwerte aus dem GBuffer (siehe auch unserer \nameref{pic:Render Graph}) und die jeweiligen 
View-Projektion-Matrizen der Kameras, um herauszufinden welche Koordinaten der jeweilige Anfangswert von Bild t im Bild t+1 
haben würde aufgrund der Drehung.
\par 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% comparrison retargeting + temporal reprojection 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage

  \begin{figure}[H]
    \begin{tcolorbox}
    \centering
    \includegraphics[width=0.6\linewidth]{content/TemporalerAlg/Bilder/Reprojection/Szene_bearbeitet.png}
    \end{tcolorbox}
    \caption{Ausschnitt(grüner Kasten) verfolgt bei Bewegungsvektor(blauer Pfeil)}
    \label{pic:TemporalReprComparison}
  \end{figure}


\begin{figure}[H]
  \begin{tcolorbox}[boxrule=4pt,sharp corners=downhill,title=Szene unter Kamerabewegung, fonttitle=\bfseries]
    %\begin{tcolorbox}[boxrule=4pt,sharp corners=downhill,title=Keine Projektion,colbacktitle=blue!50!white, coltitle=black]
    %\tcbsubtitle{Keine Projection}
    \paragraph{\hfill\colorbox{blue}{\textcolor{white}{nur Retargeting}}}
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% first row 
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \centering
    \begin{subfigure}[b]{0.2\linewidth}
      \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/NoTemporalRepr/Ausschnitte/Ausschnitt1_FFT.png}
       \caption{FT}
       \label{pic:NoTemporalRepr_1_FFT}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\linewidth}
      \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/NoTemporalRepr/Ausschnitte/Ausschnitt2_FFT.png}
      \caption{FT}
      \label{pic:NoTemporalRepr_2_FFT}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\linewidth}
      \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/NoTemporalRepr/Ausschnitte/Ausschnitt3_FFT.png}
      \caption{FT}
      \label{pic:NoTemporalRepr_3_FFT}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\linewidth}
        \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/NoTemporalRepr/Ausschnitte/Ausschnitt4_FFT.png}
        \caption{FT}
        \label{pic:NoTemporalRepr_4_FFT}
    \end{subfigure}
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% second row
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \begin{subfigure}[b]{0.2\linewidth}
        \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/NoTemporalRepr/Ausschnitte/Ausschnitt1.png}
         \caption{}
         \label{pic:NoTemporalRepr_1}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\linewidth}
        \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/NoTemporalRepr/Ausschnitte/Ausschnitt2.png}
         \caption{}
         \label{pic:NoTemporalRepr_2}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\linewidth}
        \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/NoTemporalRepr/Ausschnitte/Ausschnitt3.png}
         \caption{}
         \label{pic:NoTemporalRepr_3}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\linewidth}
        \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/NoTemporalRepr/Ausschnitte/Ausschnitt4.png}
         \caption{}
         \label{pic:NoTemporalRepr_4}
    \end{subfigure}
    %\end{tcolorbox}
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% third row 
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \tcblower
    %\begin{tcolorbox}[boxrule=4pt,sharp corners=downhill,title=Projektion,colbacktitle=green!50!white, coltitle=black]
    %\tcbsubtitle{Projection}
    \paragraph{\hfill\colorbox{blue}{\textcolor{white}{mit zusätzlichen temporalen Projezieren}}}
    \centering
    \begin{subfigure}[b]{0.2\linewidth}
      \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/TemporalRepr/Ausschnitte/Ausschnitt1_FFT.png}
       \caption{FT}
       \label{pic:TemporalRepr_1_FFT}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\linewidth}
      \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/TemporalRepr/Ausschnitte/Ausschnitt2_FFT.png}
      \caption{FT}
      \label{pic:TemporalRepr_2_FFT}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\linewidth}
      \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/TemporalRepr/Ausschnitte/Ausschnitt3_FFT.png}
      \caption{FT}
      \label{pic:TemporalRepr_3_FFT}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\linewidth}
        \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/TemporalRepr/Ausschnitte/Ausschnitt4_FFT.png}
        \caption{FT}
        \label{pic:TemporalRepr_4_FFT}
    \end{subfigure}
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 4th row
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \begin{subfigure}[b]{0.2\linewidth}
        \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/TemporalRepr/Ausschnitte/Ausschnitt1.png}
         \caption{}
         \label{pic:TemporalRepr_1}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\linewidth}
        \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/TemporalRepr/Ausschnitte/Ausschnitt2.png}
         \caption{}
         \label{pic:TemporalRepr_2}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\linewidth}
        \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/TemporalRepr/Ausschnitte/Ausschnitt3.png}
         \caption{}
         \label{pic:TemporalRepr_3}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\linewidth}
        \includegraphics[width=\linewidth]{content/TemporalerAlg/Bilder/Reprojection/TemporalRepr/Ausschnitte/Ausschnitt4.png}
         \caption{}
         \label{pic:TemporalRepr_4}
    \end{subfigure}
  %\end{tcolorbox}
  \end{tcolorbox}
    \caption{Erste beiden Reihen: kein temporales Reprojezieren; letzte beiden Reihen: Retargeting mit zusätzlichem temporalen Projezieren}
    \label{fig:Auswirkung temporales Projezieren}
\end{figure}

\begin{itemize}
  \item[nur Retargeting] Bei reinem \nameref{ch:Content2:sec:Retargeting} sieht man in der linken Hälfte des Ausschnitts Artefakte, die unsere 
                         \nameref{ch:Content1:sec:blue noise} Verteilung stören. Da zwischen den Bildern die Anfangswerte nicht projiziert
                         werden, nutzt die Bilderzeugung die anhand des vorherigen Bildes sortierten Anfangswerte. Die Sortierung allerdings
                         wurde an den vorherigen Pixelintensitäten gemacht. Da der Ausschnitt an einem inhomogenen Bildübergang gemacht wurde,
                         passen die neuen Pixelwerte nicht, um unsere \nameref{ch:Content2:sec:a Posteriori}(siehe Abschnitt \ref{ch:Content2:sec:a Posteriori})
                         Bedingung zu erfüllen. Die Anfangswerte wurden zuvor anhand völlig anderer Pixelwerte sortiert.                  
  \item[temporales Projezieren] Bei dem zusätzlichen Projizieren, wird die Bewegung
\end{itemize}

